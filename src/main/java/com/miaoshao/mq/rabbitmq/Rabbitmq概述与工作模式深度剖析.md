## mq概述
    1.什么是mq
        mq全称message queue 消息队列。是消息传送过程中保存消息的容器，多用于分布式系统之间进行通信。
        
        生产者                 中间件             消费者
        
        a系统 --------->        MQ --------->    b系统
        
    2.mq有哪些特性？
        2.1 应用解耦
            分布式环境中，如果一个系统和其他多个系统交互，当其中换一个系统挂了，那整个流程就是执行不成功，挂了。
            如果一个系统把请求消息发送到mq,同时可以及时的执行接下来的业务，这样可以不用太在意每个系统的情况，
            即使其他某个系统有问题，也不会影响。
            整个流程。
        2.2 异步提速
            如果没有加入mq,一个系统分别和其他多个系统交互，整个流程会持续很久
            如果一个系统把请求消息放入mq,就直接完成当前流程。其他子系统去mq消费消息异步执行。
        2.3 削峰
            当多个请求直达某个系统，那么这个系统承受量不够，那么就会挂掉。
            如果中间加入mq,大量请求放入到mq消息队列，可以设置系统去mq消费固定大小数量的请求。不会导致访问量
            太大而挂掉。
            
    3.mq有哪些不足？
        一旦如果mq挂掉了，那么直接业务直接收到了影响。所以需要去做高可用架构。
        mq分布式异步调用，会增加了系统的复杂度。比如消息保证如何不被丢失等等。
        
    4.常见的mq产品有哪些？
        rabbitmq : Erlang语言开发，吞吐量 万级别  最稳定的
        rocketmq ：阿里的，Java开发，吞吐量十万级  最好的，扩展性强
        kafka：apache的，Java开发，吞吐量十万级。  大数据领域，数据量大 
        
## rabbitMQ
    1.搭建mq系统
        详细教程可以自行百度，包括centos7,macos,windows都有详细教程
    2.简介
        生产者发送消息
        简历connection长链接
        每次发送简历一个channel通道
        然后发送到Exchange交换机，交换机负责分发到每个队列
        最终消息放到每个队列
        然后消费者和mq建立长链接，用来监听和从mq队列中获取消息。
    3.工作模式
        1.简单模式
            简单的生产者----消费者模式
        2.工作模式
            和简单着模式对比，增加了很多消费者，用来缓解消费者的压力。如果大量消息都在mq,那么一个消费者可能会压力很大，
            多个消费者就可以分摊大量消息。
        3.发布订阅模式
            生产者发送消息，不用直接发送到队列，而是发给交换机。
            增加了自定义交换机，通过交换机转发给不同的队列中。多个队列消息可以是相同的，相当于一个广播的方式。
        4.路由模式
            交换机通过路由绑定（Routing key）发送到不同的序列，相当于做了一个定向的发送。其实就是在广播的基础上用routing-key做了一个筛选
        5.topic模式
            交换剂通过路由绑定了队列，同时携带了routing-key过去，消费者端队列绑定交换机，同时设置通配符来批量获取那些消息。
    
    4.rabbitmq消息确认机制
        提供了监听器来监听消息投放状态，主要有连个状态confirm和return。
        conform确认消息是否发送到了mq broker，虚拟机中。 接收有两个参数：ack代表broker已经接收到消息  nack表示broker拒收消息。
        return确认消息是否投递到了相应的队列，如果该消息没有队列接收，那么就会被return。
        
## Springboot整合rabbitMQ与rabbitmq高级特性
    1.Springboot整合rabbitmq
        配置application.yml 定义host,username,pwd,vhost,port
        configuration 配置相应的交换机和队列。申明交换机和队列绑定信息
        发送者发送消息，使用rabbitmqTemplate.send
        消费者使用RabbitListener监听具体的队列，获取Message对象，包含了消息结构体。
        
    2.rabbitmq高级特性(1:10开始观看)
        （1）消息的可靠投递
            提供了两种方式来控制消息的投递。confirm和return模式。
               confirm：消息从producer到exchange会返回一个confirmCallback，回调中处理ack标识，如果为true表示发送成功
               return：消息从exchange到queue投递失败会返回一个returnCallback，setMandatory(true)，失败会将消息退回给producer
                       退回消息都在ReturnedMessage里面。
        （2）消费端限流
            大量数据发送给mq,这时候消费端就需要限制拉取消息数量，根据自己系统的能力，获取相应的消息。设置一次拉取多少消息
            消费端确认模式修改为手动确认 acknowledeg = "manual"。
        （3）TTL（存活时间）
            当消息到达存活时间，未被消费，会被自动清除
            可以设置国企时间，也可以对整个队列设置过期时间
        （4）死信队列
            当消息为死亡信息，可以发送到另一个交换机，这个交换机就是私信队列。
            如何成为死信队列？
                a.队列消息长度到达限制
                b.消费者拒绝接收，不断吧消息放入原队列。
                c.队列消息过期没有消费
        （5）延迟队列
            延迟队列，就是消息进入队列后不会立即消费，之只有到达指定时间之后，才会被消费。
            类似下单，30分钟未支付，就取消订单，回滚库存。
            但是在rabbitmq中没有提供延迟队列。但是可以用 "TTL+死信队列" 组合实现延迟队列的效果。 
             
    3.rabbitmq集群搭建介绍
        （1）集群原理
        （2）集群配置
    4.haproxy搭建介绍以及客户端代码测试
        负载均衡-HAProxy
            搭建配置：
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            